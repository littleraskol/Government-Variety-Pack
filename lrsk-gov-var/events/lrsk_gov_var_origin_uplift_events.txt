# Government Variety Pack
# Events - Uplift Origin
# Author: littleraskol

namespace = lrsk_gov_var_uplift

# Setup traits, etc.
country_event = {
	id = lrsk_gov_var_uplift.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_origin = lrsk_gov_var_origin_uplift
	}

	immediate = {
		set_country_flag = lrsk_gov_var_uplift_nation
		set_country_flag = first_contact_event
		set_country_flag = Story2 # Already encountered spacefarers

		# Swap traits out. We want the species to have the actual presapient traits for job weighting purposes.
		owner_species = { switch = {
			trigger = has_trait
			lrsk_gov_var_trait_starborn = {
				root = {
					every_owned_pop = {
						limit = { pop_has_trait = lrsk_gov_var_trait_starborn }
						modify_species = {
							species = this
							remove_trait = lrsk_gov_var_trait_starborn
							add_trait = trait_presapient_starborn
						}
						species = { save_event_target_as = lrsk_gov_var_new_uplift_species }
					}
				}
			}
			lrsk_gov_var_trait_earthbound = {
				root = {
					every_owned_pop = {
						limit = { pop_has_trait = lrsk_gov_var_trait_earthbound }
						modify_species = {
							species = this
							remove_trait = lrsk_gov_var_trait_earthbound
							add_trait = trait_presapient_earthbound
						}
						species = { save_event_target_as = lrsk_gov_var_new_uplift_species }
					}
				}
			}
			lrsk_gov_var_trait_natural_intellectuals = {
				root = {
					every_owned_pop = {
						limit = { pop_has_trait = lrsk_gov_var_trait_natural_intellectuals }
						modify_species = {
							species = this
							remove_trait = lrsk_gov_var_trait_natural_intellectuals
							add_trait = trait_presapient_natural_intellectuals
						}
						species = { save_event_target_as = lrsk_gov_var_new_uplift_species }
					}
				}
			}
			lrsk_gov_var_trait_proles = {
				root = {
					every_owned_pop = {
						limit = { pop_has_trait = lrsk_gov_var_trait_proles }
						modify_species = {
							species = this
							remove_trait = lrsk_gov_var_trait_proles
							add_trait = trait_presapient_proles
						}
						species = { save_event_target_as = lrsk_gov_var_new_uplift_species }
					}
				}
			}
			lrsk_gov_var_trait_conservative = {
				root = {
					every_owned_pop = {
						limit = { pop_has_trait = lrsk_gov_var_trait_conservative }
						modify_species = {
							species = this
							remove_trait = lrsk_gov_var_trait_conservative
							add_trait = trait_presapient_conservative
						}
						species = { save_event_target_as = lrsk_gov_var_new_uplift_species }
					}
				}
			}
			lrsk_gov_var_trait_enlightened = {
				root = {
					every_owned_pop = {
						limit = { pop_has_trait = lrsk_gov_var_trait_enlightened }
						modify_species = {
							species = this
							remove_trait = lrsk_gov_var_trait_enlightened
						}
						species = { save_event_target_as = lrsk_gov_var_new_uplift_species }
					}
					set_country_flag = lrsk_gov_var_uplift_enlighten
				}
			}
			default = { root = { set_country_flag = lrsk_gov_var_uplift_no_trait_swap } }
		} }
		
		IF = {
			limit = { OR = { 
				has_country_flag = lrsk_gov_var_uplift_enlighten
				has_country_flag = lrsk_gov_var_uplift_no_trait_swap
			} }
			add_modifier = { modifier = lrsk_gov_var_empire_enlightened }
		}
				
		IF = {
			limit = { NOT = { has_country_flag = lrsk_gov_var_uplift_no_trait_swap } }
			change_dominant_species = {
				species = event_target:lrsk_gov_var_new_uplift_species
				change_all = yes
			}
		}

		#Spawn tutor
		this.capital_scope.solar_system = {
			random_system = {
				limit = {
					has_owner = no
					distance = {
						source = prev
						min_jumps = 3
						max_jumps = 6
					}
				}
				spawn_system = { initializer = "lrsk_uplift_1" } 
			}
		}
	}
}

# Establish vassalage
#country_event = {
#	id = lrsk_gov_var_uplift.2
#	hide_window = yes
#	is_triggered_only = yes
#
#	trigger = {
#		has_origin = lrsk_gov_var_origin_uplift
#	}
#
#	immediate = {
#		set_subject_of = {
#			who = event_target:scion_master
#			subject_type = lrsk_gov_var_ward
#		}
#		add_opinion_modifier = {
#			who = event_target:scion_master
#			modifier = opinion_scion
#		}
#	}
#}



